#!/bin/bash

EXAMPLE_ROOT=$(cd $(dirname $0); pwd)/../

PLUGIN_DIR=${EXAMPLE_ROOT}/plugins
export XDG_CONFIG_HOME=${PLUGIN_DIR}

KUSTOMIZE=${EXAMPLE_ROOT}/bin/kustomize3

TARGET_BASE=${EXAMPLE_ROOT}/example/base
TARGET=$1

echo hoge ${XDG_CONFIG_HOME}

echo "=== kustomize version ==="
${KUSTOMIZE} version

echo "=== kustomize build ==="
${KUSTOMIZE} build --enable_alpha_plugins ${TARGET}

#echo "=== diff base -> target ==="
#diff -u <(${KUSTOMIZE} build ${TARGET_BASE}) <(${KUSTOMIZE} build ${TARGET})
